# ProteinUpscaler — «апскейлер» для белковых структур

Проект делает из «грубой» 3-D модели белка более точную: берёт координаты атомов из PDB-файла низкого разрешения (> 3Å) и возвращает координаты, максимально близкие к экспериментальной структуре высокого разрешения (< 2Å).  

---

## Архитектура

1. **Encoder**  
   - SE(3)-инвариантный энкодер позиций (e3nn).  
   - Эмбеддинги для типа атома («C», «N», «O» …) и типа остатка («ALA», «ARG» …).  
   - Выход: вектор фиксированной длины (256) на каждый атом.

2. **Backbone**  
   Два уровня обработки:  
   - **LocalRefinementBlock** – граф k-NN-соседей + SE(3)-эквивариантный слой (учитывает повороты и переносы).  
   - **GlobalAttentionBlock** – механизм внимания для захвата дальних взаимодействий.

3. **Head**  
   - Многослойный персептрон выдаёт вектор смещения (Δx, Δy, Δz) для каждого атома.  
   - Итоговые координаты = входные + смещение.

---

## Функция потерь

Используется **составной лосс**, который учит модель «хорошо выглядеть» как для человека, так и для физики:

| Компонент лосса | Что контролирует | Вес |
|-----------------|------------------|-----|
| **Coord RMSD**  | Среднее отклонение координат | 1.0 |
| **lDDT loss**   | Сохранение локальной топологии (расстояний между парами атомов) | 0.5 |
| **Clash penalty** | Количество стерических столкновений (Ван-дер-Ваальса) | 0.3 |
| **Physics loss** | Реалистичность длины пептидных связей C–N (1.33 ± 0.2 Å) | 0.2 |

Итог:  
`Total = 1.0·RMSD + 0.5·(1-lDDT) + 0.3·Clash + 0.2·Physics`

---

## Сравнение с AlphaFold (заглушка)

| Метод | RMSD ↓ | lDDT ↑ | Clash ↓ | Примечания |
|-------|--------|--------|---------|------------|
| AlphaFold* | — | — | — | данные будут |
| ProteinUpscaler | — | — | — | после обучения |
| … | … | … | … | … |

---

## Что в репозитории

```
upscaler/
├── model/           # архитектура сети
├── loss/            # функция потерь
├── data/            # датасет и выравнивание структур
├── training/        # пайп-лайн и кросс-валидация по семействам
├── utils/           # метрики качества (RMSD, lDDT, clash-score)
└── tests/           # юнит-тесты компонентов
```

---

## Статус

- Код готов к обучению.  
- Все юнит-тесты проходят.  
- Датасет собран из PDB (пары «плохое → хорошее» разрешение).  
